<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Testando Voice RSS com Download e Logs</title>
</head>
<body>
    <h1>Testando Voice RSS com Download e Logs</h1>
    
    <div class="container-audio">
        <div class="mb-3">
            <pre class="Texto-download form-control">
                <!-- Logs aparecerão aqui -->
            </pre>
        </div>

        <div class="mb-3">
            <audio class="audio-player mt-3" controls>
                Seu navegador não suporta o elemento de áudio.
            </audio>
        </div>
        
        <div class="text-center">
            <button class="btn btn-primary download-btn">Download Áudio</button>
        </div>
    </div>

    <script>
        document.querySelector(".download-btn").addEventListener('click', function () {
            const texto = "Olá, mundo!";  // Texto de exemplo
            const logPre = document.querySelector(".Texto-download");
            logPre.textContent += `Texto para sintetizar: ${texto}\n`;

            // API Voice RSS para síntese de voz
            const apiUrl = `https://api.voicerss.org/`;
            const apiKey = 'e3f17edd7b9c4d6cb3a333b278aae0e9'; // Substitua pela sua chave da API Voice RSS

            const params = new URLSearchParams({
                key: apiKey,
                src: texto,
                hl: 'pt-br',
                r: '0',  // Velocidade normal
                c: 'MP3',  // Formato do áudio
                f: '44khz_16bit_stereo'  // Qualidade
            });

            // Registrar o log do início do processo
            logPre.textContent += `Iniciando a requisição para Voice RSS...\n`;

            fetch(`${apiUrl}?${params.toString()}`, {
                method: 'GET',
            })
            .then(response => {
                if (response.ok) {
                    logPre.textContent += 'Áudio gerado com sucesso!\n';
                    return response.blob();
                } else {
                    logPre.textContent += 'Erro ao gerar o áudio.\n';
                    throw new Error('Erro ao gerar áudio');
                }
            })
            .then(blob => {
                if (blob) {
                    const url = URL.createObjectURL(blob);
                    const audio = document.querySelector(".audio-player");
                    audio.src = url;

                    // Criar link para baixar o arquivo de áudio
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = 'audio.mp3';
                    link.click();

                    logPre.textContent += 'Áudio baixado com sucesso.\n';
                }
            })
            .catch(error => {
                logPre.textContent += `Erro: ${error.message}\n`;
            });
        });
    </script>
</body>
</html>
